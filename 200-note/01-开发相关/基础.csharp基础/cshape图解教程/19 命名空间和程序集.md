#csharp图解编程  #csharp学习 #学习笔记 

# 1 命名空间和程序集：

命名空间是一种用来组织和管理代码的机制，它允许在逻辑上将类、接口和其他类型的成员组织在一起。程序集是一个部署单元，它可以包含一个或多个相关的命名空间和类型的集合。一个程序集可以是一个动态链接库 (DLL) 或一个可执行文件 (EXE)。

## 1.1 引用其他程序集：

在开发中，有时候我们需要在一个项目中使用其他已经存在的程序集中的功能。为了实现这个目的，我们需要在项目中引用这些外部程序集，以便在我们的代码中使用其中的类和方法。

## 1.2 mscorlib库：

mscorlib是.NET Framework中的一个核心程序集，它包含了一些基本的类型和功能，如基本数据类型、异常处理机制等。在C#中，这些基础功能通常是默认引用的，无需手动引用。

# 2 命名空间：

命名空间是在C#代码中用来组织和管理类和其他类型的标识符的一种机制。通过使用命名空间，我们可以在项目中创建有层次结构的组织，避免命名冲突，并提高代码的可维护性。

命名空间的定义：
1. 你可以把命名空间名视为一个字符串（在字符串中可以使用点），它加在类名或类型名的前面并且通过点进行分隔
2. 包括命名空间名、分隔点，以及类名的完整字符串叫做类的完全限定名
3. 命名空间是共享命名空间名的一组类和类型

```csharp
  关键字   命名空间名
    ↓          ↓
namespace NamespaceName
{
    TypeDeclarations
}
```

## 2.1 命名空间名称：

命名空间名称是唯一标识一个命名空间的字符串。在C#中，命名空间名称是全局唯一的，这意味着不同项目中不能有相同的命名空间名称。

下面是命名空间命名指南：

1. 使用公司名开始命名空间名称
2. 在公司名之后跟着技术名称
3. 不要把命名空间命名为与类或类型相同的名称

## 2.2 其他知识点

关于命名空间，有其他几个要点应该知道。

1. 在命名空间内，每个类型名必须有别于所有其他类型
2. 命名空间内的类型称为命名空间的成员
3. 一个源文件可以包含任意数目的命名空间声明，可以顺序也可以嵌套
4. 命名空间不是封闭的。这意味着可以在该源文件的后面或另一个源文件中再次声明它，以对它增加更多的类型声明。
5. 命名空间可以被嵌套，从而产生嵌套的命名空间。嵌套命名空间允许你创建类型的概念层次。
	1. 原文嵌套 可以把命名空间的声明放在一个封装的命名空间声明体内部，从而创建一个嵌套的命名空间。
	2. 分离的声明 也可以为嵌套命名空间创建分离的声明，但必须在声明中使用它的完全限定名称。

# 3 using 指令：

完全限定名可能相当长，在代码中通篇使用它们十分繁琐。然而，有两个编译器指令，可以使你避免使用完全限定名：using命名空间指令和using别名指令。

关于using指令的两个要点如下：

1. 它们必须放在源文件的顶端，在任何类型声明之前
2. 它们应用于当前源文件中的所有命名空间

## 3.1 using命名空间指令：
using命名空间指令用于在代码文件中引用其他命名空间，使得我们可以在代码中使用该命名空间中定义的类型，而无需使用完整的命名空间路径。

```csharp
关键字
  ↓
using System;
        ↑
    命名空间的名称
```

## 3.2 using别名指令：
using别名指令允许我们为一个命名空间或类型定义一个简短的别名，以方便在代码中使用。这对于解决命名冲突或者简化较长命名空间路径很有用。
```csharp
关键字 别名 命名空间
  ↓     ↓    ↓
using Syst=System;
using SC=System.Console;
               ↑
              类
```


# 4 程序集的结构：

程序集不包含本地机器代码，而是公共中间语言代码。它还包含实时编译器（JIT）在运行时转换CIL到本机代码所需的一切，包括对它所引用的其他程序集的引用。程序集的文件扩展名通常为.exe或.dll。具体来说程序集包含一下4个主要部分

1. 清单：
	1. 程序集名称标识符
	2. 组成程序集的文件列表
	3. 一个指示程序集中内容在哪里的地图
	4. 关于引用的其他程序集的信息
2. 类型元数据：包含该程序集中定义的所有类型的信息。这些信息包含关于每个类型要知道的所有事情
3. CIL代码：包含程序集的所有中间代码
4. 资源：是可选的，可以包含图形或语言资源

程序集代码文件称为模块。尽管大部分程序集由单文件组成，但有些也有多个文件。对于有多个模块的程序集，一个文件是主模块（primary module )，而其他的是次要模块（secondary modules )。

1. 主模块含有程序集的清单和到次要模块的引用
2. 次要模块的文件名以扩展名.netmodule结尾
3. 多文件程序集被视为一个单一单元。它们一起部署并一起定版


## 4.1 程序集标识符：
程序集标识符是一个用于唯一标识一个程序集的字符串。在.NET中，程序集标识符通常使用名称、版本号、公钥标记等信息来构成。在.NET框架中，程序集的文件名不像在其他操作系统和环境中那么重要，更重要的是程序集的标识符（identity )。

程序集的标识符有4个组成部分，它们一起唯一标识了该程序集，如下所示。

1. 简单名 这只是不带文件扩展名的文件名。每个程序集都有一个简单名。它也被称为程序集名或友好名称（friendly name）
2. 版本号 它由4个句点分开的整数字符串组成，形式为MajorVersion.MinorVersion.Build.Revision，例如2.0.35.9
3. 文化信息 它是一个字符串，由2~5个字符组成，代表一种语言，或代表一种语言和一个国家或地区。例如，在美国使用英语的文化名是en-US。在中国使用中文，它是zh-CN。
4. 公钥 这个128字节字符串应该是生产该程序集的公司唯一的

## 4.2 强命名程序集：
强命名（strongly named）程序集有一个唯一的数字签名依附于它。强命名程序集比没有强名称的程序集更加安全，原因有以下几点。

1. 强名称唯一标识了程序集。没有其他人能创建一个与之有相同名称的程序集，所以用户可以确信该程序集来自于其声称的来源
2. 没有CLR安全组件来捕获更改，带强名称的程序集的内容不能被改变

弱命名(weakly named )程序集是没有被强命名的程序集。由于弱命名程序集没有数字签名， 它天生是不安全的。因为一根链的强度只和它最弱的一环相同，所以强命名程序集默认只能访问其他强命名程序集。

程序员不产生强名称。编译器产生它，接受关于程序集的信息，并散列化这些信息以创建一个唯一的数据签名依附到该程序集。它在散列处理中使用的信息如下：
- 组成程序集的字节序列
- 简单名称
- 版本号
- 文化信息
- 公钥/私钥对

![Pasted image 20230802172444](https://cdn.jsdelivr.net/gh/Ailurus-2233/PicGo-ImageRepo@main/work-Image/202308281116996.png)


## 5 共享程序集和GAC：
共享程序集是一种供多个应用程序共享的程序集，它们通常存储在GAC（全局程序集缓存）中。

17. 把程序集安装到GAC：
将程序集安装到GAC中需要使用GAC工具（gacutil.exe），这样其他应用程序就可以共享使用该程序集。

18. GAC内的并肩执行：
GAC支持在同一个机器上运行多个不同版本的程序集，这称为并肩执行。它允许不同的应用程序使用它们所需的特定版本，而不会相互干扰。

19. 配置文件：
配置文件是用来存储应用程序配置信息的文件，例如数据库连接字符串、日志设置等。它允许应用程序在运行时动态修改配置，而不需要重新编译代码。

20. 延迟签名：
延迟签名是指在创建程序集时不立即签名，而是在后续的步骤中进行签名。这样可以在开发过程中保持灵活性，并允许在发布之前对程序集进行最终的签名。
