#csharp图解编程 #csharp学习 #学习笔记

# 1 方法的构成

1. 方法头：返回类型，方法名称，参数列表
2. 方法体：顺序执行的语句序列。主要的类型有：局部变量，控制流结构，方法调用，内嵌的块，其他方法（局部函数）。

# 2 变量与常量

1. 局部变量：Type identify = Value;
    1. 生存期：块中被声明开始，块执行完结束
    2. 初始化：没有隐式初始化，被使用前没有赋值会报错
    3. 存储区域：值类型：栈，引用类型：引用在栈，实例数据在堆
2. 类型推断关键字 var，不同于JavaScript的var，它还是强类型的体现，var通过等号右侧的语句推断类型并确定，该变量的类型在程序执行过程中同样是不可变的。
3. 局部常量：const Type identify = Value;

# 3 控制流语句

1. 选择语句：if，if...else...，switch
2. 迭代语句：for，while，do，foreach
3. 跳转语句：break，continue，goto，return

# 4 参数

1. 形参：形参是局部变量，它声明在方法的参数列表中
2. 实参：调用方法时，传入的参数

# 5 值参数

当使用参数时，通过将参数的值复制到形参的方式把数据传递给方法

传递过程：

1. 在栈中为形参分配空间；
2. 将实参的值复制给形参

# 6 引用参数

使用方法：1. 声明和使用时必须使用ref修饰符。2. 实参必须是变量

A. 声明时：void MyMethod(ref int arg1) {}

B. 使用时：MyMethod(ref y);

传递过程：

1. 不会在栈上为形参分配内存；
2. 形参的参数名将作为实参变量的别名，指向相同的内存位置。

# 7 输出参数

使用方法：

1. 声明和使用时必须使用out修饰符。
2. 实参必须是变量。
3. 在方法内部，给输出参数赋值之后才能读取它
4. 在方法内部，在方法返回前，必须为所有的可能的路径为所有的输出参数赋值。

# 8 参数数组

使用方法：

1. 一个参数列表中只能有一个参数数组
2. 如果有，他必须是最后一个
3. 参数数组的参数类型必须相同
4. 在数据类型前使用params修饰符
5. 在数据类型后放置一组空的方括号
6. 也可将数组作为实参传给方法，这时编译器会使用你的数组而不是重新创建一个

# 9 ref 高级用法

1. 声明别名：ref int y = ref x;
2. ref 返回：把私有属性作为引用传出给外部访问。

```
private int Score = 5;

public ref int RefToValue()
{
    return ref Score;
}
```

注：

1. 不能将void的方法声明为ref返回方法
2. ref return 不能返回如下内容：
    1. 空值；
    2. 常量；
    3. 枚举成员；
    4. 类或者结构体属性；
    5. 指向只读位置的指针
3. ref return 表达式只能指向原先就在调用域内的位置，或者字段；
4. ref 局部变量只能赋值一次，初始化后不能指向不同的存储位置；
5. 如果在调用时省略ref关键字，则获取到的时值而不是引用；
6. 如果将ref局部变量作为常规的实际参数传递给其他方法，则是取值进行值传递而不是引用传递。

# 10 命名参数

在方法调用时可以使用如下的方式：

```
c.Calc(c:2,a:4,b:3);
```

1. 方法声明不变
2. 在调用时，形参的名字后面跟着冒号和实际的参数值或表达式。

# 11 可选参数

1. 方法声明时，设置初始值
2. 如果调用时缺少该参数，则使用默认值。
3. 只有值类型可以设置任意默认值，引用类型的默认值只能为null
4. 参数列表的顺序是，必填参数，可选参数，params参数

# 12 栈帧

1. 栈帧的内容：
    1. 返回地址
    2. 分配内存的参数
    3. 和方法调用相关的其他管理数据项
2. 方法调用时，整个栈帧会入栈
3. 在方法退出的时候，整个栈帧会弹出。

# 13 方法重载

一个类中可以有多个同名方法，这叫做方法重载（overloading），但名称相同的方法必须有不同的签名

其中签名包括：

1. 方法的名称
2. 参数的数量
3. 参数的数据类型和顺序
4. 参数修饰符
5. 注：返回值类型和形参名称不是方法的签名